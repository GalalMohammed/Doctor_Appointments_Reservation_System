@using DAL.Enums
@model DoctorEditViewModel
@{
    ViewData["Title"] = "Edit Profile";
}

<form asp-action="Edit" class="d-flex flex-column gap-2 col-10 col-md-6 mx-auto" method="post" style="padding: 100px 20px 20px; color: var(--primary-color)" enctype="multipart/form-data">
    <h2>Enter Your Information</h2>
    <div asp-validation-summary="All" class="text-danger"></div>
    <div class="accordion form-container" id="doctorRegisterAccordion">

        <!-- Personal Information -->
        <div class="accordion-item doctor-register-div">
            <h2 class="accordion-header" id="headingPersonal">
                <button class="accordion-button" type="button">
                    Personal Information
                </button>
            </h2>
            <div id="collapsePersonal" class="accordion-collapse show">
                <div class="accordion-body register-input-group d-flex flex-column gap-3 justify-content-between">
                    <div class="row gap-1 gap-md-0">
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="FirstName" class="my-1"></label>
                            <input asp-for="FirstName" class="login-form-input rounded-1" readonly="readonly" />
                            <span asp-validation-for="FirstName" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="LastName" class="my-1"></label>
                            <input asp-for="LastName" class="login-form-input rounded-1" readonly="readonly" />
                            <span asp-validation-for="LastName" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row gap-1 gap-md-0">
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="Gender" class="form-label"></label>
                            <input asp-for="Gender" class="login-form-input rounded-1" readonly="readonly" />
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="BirthDate" class="form-label"></label>
                            <input asp-for="BirthDate" class="login-form-input rounded-1 form-control" type="date" readonly="readonly" />
                            <span asp-validation-for="BirthDate" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="mb-3 col-12 col-md-6">
                        <label asp-for="Image" class="form-label"></label>
                        <input asp-for="Image" class="login-form-input rounded-1 form-control" type="file" />
                        <span asp-validation-for="Image" class="text-danger"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Information -->
        <div class="accordion-item doctor-register-div">
            <h2 class="accordion-header" id="headingContact">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseContact">
                    Contact Information
                </button>
            </h2>
            <div id="collapseContact" class="accordion-collapse collapse" data-bs-parent="#doctorRegisterAccordion">
                <div class="accordion-body register-input-group d-flex flex-column gap-3 justify-content-between">
                    <div class="row gap-1 gap-md-0">
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="Email" class="form-label"></label>
                            <input asp-for="Email" class="login-form-input rounded-1 form-control" readonly="readonly" />
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="PhoneNumber" class="form-label"></label>
                            <input asp-for="PhoneNumber" class="login-form-input rounded-1 form-control" />
                            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row gap-1 gap-md-0">
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="Governorate" class="form-label"></label>
                            <select asp-for="Governorate" asp-items="Html.GetEnumSelectList<Governorate>()" class="login-form-input rounded-1 form-select"></select>
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="Address" class="form-label"></label>
                            <input asp-for="Address" class="login-form-input rounded-1 form-control" />
                            <span asp-validation-for="Address" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="d-flex flex-column justify-content-evenly align-items-center">
                        <p class="align-self-start">Pick Your Location</p>
                        <span id="doctor-register-pick-location" class="btn login-submit mb-3">Pick Automatically (Permission Nedded)</span>
                        <div id="map" style="height: 300px; width: 100%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Professional Details -->
        <div class="accordion-item doctor-register-div">
            <h2 class="accordion-header" id="headingProfessional">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProfessional">
                    Professional Details
                </button>
            </h2>
            <div id="collapseProfessional" class="accordion-collapse collapse" data-bs-parent="#doctorRegisterAccordion">
                <div class="accordion-body register-input-group d-flex flex-column gap-3 justify-content-between">
                    <div class="mb-3">
                        <label asp-for="Specialty" class="form-label"></label>
                        <input asp-for="Specialty" class="login-form-input rounded-1 form-control" readonly="readonly" />
                    </div>
                    <div class="row gap-2 gap-md-0">
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="Fees" class="form-label"></label>
                            <input asp-for="Fees" class="login-form-input rounded-1 form-control" />
                            <span asp-validation-for="Fees" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <label asp-for="WaitingTime" class="form-label"></label>
                            <input asp-for="WaitingTime" class="login-form-input rounded-1 form-control" />
                            <span asp-validation-for="WaitingTime" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label asp-for="About" class="form-label"></label>
                        <textarea asp-for="About" class="login-form-input rounded-1 form-control"></textarea>
                        <span asp-validation-for="About" class="text-danger"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Availability -->
        @* <div class="accordion-item doctor-register-div"> *@
        @*     <h2 class="accordion-header" id="headingAvailability"> *@
        @*         <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAvailability"> *@
        @*             Availability *@
        @*         </button> *@
        @*     </h2> *@
        @*     <div id="collapseAvailability" class="accordion-collapse collapse" data-bs-parent="#doctorRegisterAccordion"> *@
        @*         <div class="accordion-body register-input-group d-flex flex-column gap-3 justify-content-between"> *@
        @*             @for (var i = 0; i < days.Length; i++) *@
        @*             { *@
        @*                 <div class="mb-3"> *@
        @*                     <div class="d-lg-flex justify-content-between align-items-center"> *@
        @*                         <div class="d-flex gap-2 mb-1"> *@
        @*                             <input asp-for="Days[@i].Exists" class="form-check-input" /> *@
        @*                             <label asp-for="Days[@i].Exists" class="form-check-label">@days[i]</label> *@
        @*                         </div> *@
        @*                         <div class="d-flex gap-lg-5 p-2"> *@
        @*                             <div class="d-flex align-items-center w-50"> *@
        @*                                 <label asp-for="Days[@i].StartTime" class="me-2"></label> *@
        @*                                 <input asp-for="Days[@i].StartTime" class="doctor-edit-time form-control" type="time" style="width: 100px;" /> *@
        @*                             </div> *@
        @*                             <div class="d-flex justify-content-end align-items-center w-50"> *@
        @*                                 <label asp-for="Days[@i].EndTime" class="me-2"></label> *@
        @*                                 <input asp-for="Days[@i].EndTime" class="doctor-edit-time form-control" type="time" style="width: 100px;" /> *@
        @*                             </div> *@
        @*                         </div> *@
        @*                     </div> *@
        @*                     <span asp-validation-for="Days[@i].EndTime" class="text-danger text-end"></span> *@
        @*                 </div> *@
        @*             } *@
        @*         </div> *@
        @*     </div> *@
        @* </div> *@

        <!-- Availability -->
        @* <div class="accordion-item doctor-register-div"> *@
        @*     <h2 class="accordion-header" id="headingAvailability"> *@
        @*         <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAvailability"> *@
        @*             Availability *@
        @*         </button> *@
        @*     </h2> *@
        @*     <div id="collapseAvailability" class="accordion-collapse collapse" data-bs-parent="#doctorRegisterAccordion"> *@
        @*         <div class="accordion-body register-input-group d-flex flex-column gap-3 justify-content-between"> *@


        @*             <div class="row gap-2 gap-md-0"> *@
        @*                 <div class="col-md-6 col-sm-12"> *@
        @*                     <label asp-for="Days[0].StartTime" class="form-label"></label> *@
        @*                     <input asp-for="Days[0].StartTime" class="form-control" type="time" /> *@
        @*                     <span asp-validation-for="Days[0].StartTime" class="text-danger"></span> *@
        @*                 </div> *@
        @*                 <div class="col-md-6 col-sm-12"> *@
        @*                     <label asp-for="Days[0].EndTime" class="form-label"></label> *@
        @*                     <input asp-for="Days[0].EndTime" class="form-control" type="time" /> *@
        @*                     <span asp-validation-for="Days[0].EndTime" class="text-danger"></span> *@
        @*                 </div> *@
        @*             </div> *@
        @*             <div class="mb-3"> *@
        @*                 <label asp-for="Days[0].Exists" class="form-label"></label> *@
        @*                 <div class="p-2 d-flex justify-content-between flex-wrap gap-2"> *@
        @*                     @foreach(var day in Enum.GetNames<WorkingDays>()) *@
        @*                     { *@
        @*                         <div class="doctor-register-days col-5 col-md-3"> *@
        @*                             <input type="checkbox" id="@day" name="@day" class="form-check-inline" /> *@
        @*                             <label for="@day" class="form-check-label">@day</label> *@
        @*                         </div> *@
        @*                     } *@
        @*                 </div> *@
        @*             </div> *@
        @*                 <label asp-for="ReservationQuota" class="form-label"></label> *@
        @*                 <input asp-for="ReservationQuota" class="form-control" /> *@
        @*                 <span asp-validation-for="ReservationQuota" class="text-danger"></span> *@
        @*             </div> *@
        @*         </div> *@
        @*     </div> *@
        @* </div> *@

        <input asp-for="Lat" class="d-none" />
        <input asp-for="Lng" class="d-none" />
        <input asp-for="Id" class="d-none" />
        <input asp-for="ImageURL" class="d-none" />
    </div>
    <div class="d-flex justify-content-center m-3">
        <input type="submit" class="btn login-submit mb-3 w-50" value="Edit" />
    </div>
</form>

@section Styles {
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
}

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="~/js/doctor-register.js"></script>
    <script>
        document.querySelectorAll(".SP-toggle-password").forEach(button => {
            button.addEventListener("click", function() {
                let input = document.querySelector(this.getAttribute("data-target"));
                let icon = this.querySelector(".eye-icon");

                if (input.type === "password") {
                    input.type = "text";
                    icon.classList.replace("fa-eye", "fa-eye-slash"); // Change icon to eye-slash
                } else {
                    input.type = "password";
                    icon.classList.replace("fa-eye-slash", "fa-eye"); // Change icon to eye
                }
            });
        });
    </script>
    @if (ViewBag?.Success ?? false)
    {
        <script type="module">
            Swal.fire({
                title: "Success",
                text: "Your profile has been updated!",
                color: "#004085",
                confirmButtonColor: "#004085",
                icon: "success"
            });
        </script>
    }
    <partial name="_ValidationScriptsPartial" />
}